# PIVOT Configuration
# Prompting with Iterative Visual Optimization for Drone Navigation

# ============================================================================
# API Provider Configuration
# ============================================================================
# Choose between "gemini" or "openai" (OpenAI-compatible API)
api_provider: "gemini"

# Specify the exact model name to use
# Leave empty to use provider defaults
# Examples: "gemini-2.5-flash", "gemini-2.5-pro", "openai/gpt-4.1"
model_name: "gemini-2.5-pro"

# ============================================================================
# PIVOT Algorithm Parameters
# ============================================================================
# Number of trajectory options to present per iteration
num_candidates: 10

# Maximum number of refinement iterations
# Recommended: 3-4 for balance of accuracy and VLM cost
max_iterations: 2

# Search radius reduction factor per iteration
# Each iteration reduces search space by this factor
# 0.5 = 50% reduction (recommended)
refinement_factor: 0.5

# Paper-style PIVOT selection: choose top-K candidates each iteration
# Used in the adapted navigation prompt JSON: {"points":[...]}
vlm_select_k: 1

# ============================================================================
# Candidate Generation Bounds
# ============================================================================
# All ranges in meters, camera-relative coordinates
# x-axis: lateral (negative = left, positive = right)
# y-axis: depth (positive = forward)
# z-axis: vertical (negative = down, positive = up)

# Extended ranges for better coverage
depth_range: [0.5, 3.0]         # Forward distance range (extended)
lateral_range: [-2.0, 2.0]      # Left/right range (extended)
vertical_range: [-1.0, 1.0]     # Up/down range (extended)

# ============================================================================
# Execution (Paper-style depth-limited step)
# ============================================================================
# Use AirSim depth image to limit how far the drone moves along the selected direction.
enable_depth_step_limit: true
# Maximum step distance in meters (paper mobile manipulator uses max 1.0m).
max_step_distance_m: 1.0
# Optional safety margin: subtract from depth before limiting.
depth_step_margin_m: 0.0

# ============================================================================
# Image and Camera Configuration
# ============================================================================
image_width: 1920
image_height: 1080
camera_name: "0"

# Field of view (degrees)
fov_horizontal: 90.0
fov_vertical: 90.0

# ============================================================================
# Coordinate Frame Notes
# ============================================================================
# Waypoints are in camera-relative coordinates:
# - dx: lateral (negative=left, positive=right)
# - dy: forward (positive=forward)
# - dz: vertical (positive=up)
#
# AirSim's body frame already aligns with camera frame for forward-facing cameras.
# No coordinate transformation is needed.

# ============================================================================
# Processing Configuration
# ============================================================================
# Delay in seconds between navigation cycles
# 0 = no delay (continuous operation)
# 1-2 = recommended for testing
command_loop_delay: 1

# ============================================================================
# AirSim Movement Configuration
# ============================================================================
base_velocity: 2.0               # Base velocity in m/s
base_yaw_rate: 30.0              # Base yaw rate in degrees/s
min_command_duration: 2.0        # Minimum duration for movement commands


# ============================================================================
# Visualization and Logging
# ============================================================================
# Save iteration visualizations and results
save_iterations: true

# Output directory for visualizations
# Timestamped subdirectories will be created
output_dir: "pivot_visualizations"

# Enable enhanced paper-style visualizations
# Generates progressive refinement composites, before/after comparisons
enable_advanced_visualization: true

# ============================================================================
# Navigation
# ============================================================================
# Default instruction if none provided via command line
default_instruction: "fly to the red car"

# ============================================================================
# NEW: Parallel Execution (Ensemble - Paper Section 3.3)
# ============================================================================
# Run E parallel PIVOT instances for robustness
# 1 = single instance (no parallelism)
# 3-5 = recommended for robust ensemble execution
num_parallel_instances: 3

# Result aggregation method
# "voting" = majority vote on similar trajectories (recommended)
# "confidence" = weight by VLM confidence scores
# "average" = average waypoint positions
aggregation_method: "vlm"
# "vlm" = query VLM again to pick best among E final actions (paper Section 3.3 option 2)

# Enable parallel execution
# false (default) = single PIVOT instance
# true = run num_parallel_instances in parallel
enable_parallel_execution: true

# ============================================================================
# Advanced Options
# ============================================================================
 
